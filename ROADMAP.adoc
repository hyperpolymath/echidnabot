// SPDX-License-Identifier: PMPL-1.0-or-later

= Echidnabot Roadmap

:toc: macro
:toclevels: 3
:icons: font

Development roadmap for echidnabot - Proof-Aware CI Bot.

*Last Updated:* 2026-01-29 +
*Current Version:* v0.1.0 +
*Overall Completion:* 75%

toc::[]

== Vision

Echidnabot aims to be the **definitive formal verification CI bot**, orchestrating ECHIDNA to verify mathematical proofs automatically on every push across all major git forges.

== Current Status (v0.1.0 - January 2026)

=== Milestone Summary

[cols="1,2,1,1"]
|===
|Milestone |Description |Status |Completion

|Core Infrastructure
|Axum server, webhooks, database, GraphQL
|‚úÖ Complete
|100%

|Platform Integration
|GitHub/GitLab/Bitbucket adapters
|‚úÖ Complete
|100%

|ECHIDNA Integration
|HTTP client, job dispatch, results
|‚úÖ Complete
|100%

|Job Scheduler
|Queue, PostgreSQL, status tracking
|üöß In Progress
|60%

|Container Isolation
|Docker, resource limits, security
|üìã Planned
|0%

|Bot Modes
|Verifier/Advisor/Consultant/Regulator
|üìã Planned
|0%

|Production Hardening
|Error recovery, observability, rate limiting
|üìã Planned
|0%
|===

=== Detailed Component Status

[cols="1,3,1"]
|===
|Component |Status |Completeness

|**Core Infrastructure** (Complete)
|
|

|HTTP Server (Axum)
|‚úÖ Implemented
|100%

|Webhook receivers (GitHub/GitLab/Bitbucket)
|‚úÖ Implemented
|100%

|Webhook signature verification (HMAC-SHA256)
|‚úÖ Implemented
|100%

|GraphQL API (queries + mutations)
|‚úÖ Implemented
|100%

|Database schema (sqlx migrations)
|‚úÖ Implemented
|100%

|Configuration system
|‚úÖ Implemented
|100%

|Error handling
|‚úÖ Implemented
|100%

|**Platform Adapters** (Complete)
|
|

|PlatformAdapter trait
|‚úÖ Implemented
|100%

|GitHub adapter (octocrab)
|‚úÖ Implemented
|100%

|GitLab adapter
|‚úÖ Implemented
|100%

|Bitbucket adapter
|‚úÖ Implemented
|100%

|Check run creation
|‚úÖ Implemented
|100%

|PR/MR comments
|‚úÖ Implemented
|100%

|**ECHIDNA Integration** (Complete)
|
|

|HTTP client (reqwest)
|‚úÖ Implemented
|100%

|Prover enumeration (12 provers)
|‚úÖ Implemented
|100%

|Job dispatch to ECHIDNA
|‚úÖ Implemented
|100%

|Result parsing
|‚úÖ Implemented
|100%

|**Job Scheduler** (In Progress - 60%)
|
|

|Basic job queue
|‚úÖ Implemented
|100%

|PostgreSQL persistence
|‚úÖ Implemented
|100%

|Job status tracking
|‚úÖ Implemented
|100%

|Retry logic with backoff
|‚ùå TODO (HIGH PRIORITY)
|0%

|Concurrent job limits
|‚ùå TODO (HIGH PRIORITY)
|0%

|Priority queue
|‚ùå TODO
|0%

|**Container Isolation** (Planned - 0%)
|
|

|Docker container spawning
|‚ùå TODO (HIGH PRIORITY - Security)
|0%

|Resource limits (CPU/memory/time)
|‚ùå TODO (HIGH PRIORITY - Security)
|0%

|Read-only filesystem
|‚ùå TODO (HIGH PRIORITY - Security)
|0%

|Network isolation
|‚ùå TODO (HIGH PRIORITY - Security)
|0%

|Pre-built prover images
|‚ùå TODO
|0%

|**Bot Modes** (Planned - 0%)
|
|

|Verifier mode (silent pass/fail)
|‚ùå TODO (Next after container isolation)
|0%

|Advisor mode (tactic suggestions)
|‚ùå TODO
|0%

|Consultant mode (Q&A)
|‚ùå TODO
|0%

|Regulator mode (merge blocking)
|‚ùå TODO
|0%

|**Production Features** (Planned - 0%)
|
|

|Observability (Prometheus metrics)
|‚ùå TODO
|0%

|Distributed tracing (OpenTelemetry)
|‚ùå TODO
|0%

|Rate limiting
|‚ùå TODO
|0%

|Docker Compose setup
|‚ùå TODO
|0%

|Kubernetes deployment
|‚ùå TODO
|0%
|===

=== All 12 Provers Supported (via ECHIDNA)

[cols="1,2,1"]
|===
|Prover |Integration Method |Status

|Coq
|ECHIDNA HTTP API ‚Üí Coq backend
|‚úÖ Via ECHIDNA

|Lean 4
|ECHIDNA HTTP API ‚Üí Lean backend
|‚úÖ Via ECHIDNA

|Isabelle/HOL
|ECHIDNA HTTP API ‚Üí Isabelle backend
|‚úÖ Via ECHIDNA

|Agda
|ECHIDNA HTTP API ‚Üí Agda backend
|‚úÖ Via ECHIDNA

|Z3
|ECHIDNA HTTP API ‚Üí Z3 SMT backend
|‚úÖ Via ECHIDNA

|CVC5
|ECHIDNA HTTP API ‚Üí CVC5 SMT backend
|‚úÖ Via ECHIDNA

|ACL2
|ECHIDNA HTTP API ‚Üí ACL2 backend
|‚úÖ Via ECHIDNA

|PVS
|ECHIDNA HTTP API ‚Üí PVS backend
|‚úÖ Via ECHIDNA

|HOL4
|ECHIDNA HTTP API ‚Üí HOL4 backend
|‚úÖ Via ECHIDNA

|Mizar
|ECHIDNA HTTP API ‚Üí Mizar backend
|‚úÖ Via ECHIDNA

|HOL Light
|ECHIDNA HTTP API ‚Üí HOL Light backend
|‚úÖ Via ECHIDNA

|Metamath
|ECHIDNA HTTP API ‚Üí Metamath backend
|‚úÖ Via ECHIDNA
|===

**Note:** echidnabot delegates all proof verification to ECHIDNA. Prover support depends on ECHIDNA backend availability.

== Critical Next Actions

=== Immediate (This Week)

1. **Container Isolation** (HIGH PRIORITY - Security)
   - Implement Docker container spawning for proof verification
   - Add resource limits (CPU: 2 cores, Memory: 4GB, Timeout: 300s)
   - Read-only filesystem setup
   - Network isolation (no outbound connections)
   - **Why Critical:** Running untrusted code from PRs without isolation is a security risk

2. **Retry Logic with Exponential Backoff** (HIGH PRIORITY - Reliability)
   - Add exponential backoff for failed jobs (1s, 2s, 4s, 8s, ...)
   - Distinguish transient vs permanent failures
   - Configurable retry limits (default: 3 attempts)
   - **Why Critical:** Temporary failures (network issues, ECHIDNA busy) currently become permanent

3. **Concurrent Job Execution Limits** (HIGH PRIORITY - Stability)
   - Implement job concurrency limits (default: 10 concurrent verifications)
   - Fair scheduling across repositories
   - Priority queue for urgent jobs (HEAD commits higher priority than PR branches)
   - **Why Critical:** Unlimited concurrency can exhaust host resources

=== This Week

4. **Verifier Mode Implementation**
   - Silent pass/fail checks (basic bot mode)
   - Create GitHub Check Run with status
   - Basic PR comment on failure
   - **First bot mode to implement** (simplest, highest value)

5. **Docker Compose Setup**
   - PostgreSQL + echidnabot + ECHIDNA in one `docker-compose up`
   - Easy local development environment
   - Production-like configuration

6. **Integration Tests**
   - End-to-end: webhook ‚Üí verification ‚Üí result flow
   - Test with real GitHub webhook payloads
   - Mock ECHIDNA API responses
   - Database fixture setup/teardown

== Near-Term Goals (v0.2.0 - Q1 2026)

=== 1. Complete Job Scheduler (HIGH PRIORITY)

**Effort:** 1-2 weeks

* [x] Basic job queue ‚úÖ
* [x] PostgreSQL persistence ‚úÖ
* [x] Job status tracking ‚úÖ
* [ ] Retry logic with exponential backoff (THIS WEEK)
* [ ] Concurrent job execution limits (THIS WEEK)
* [ ] Priority queue (urgent jobs first)
* [ ] Dead letter queue (permanently failed jobs)
* [ ] Job cancellation (cancel in-progress jobs)

**Why:** Ensure reliable job processing even under load or transient failures.

=== 2. Container Isolation (HIGH PRIORITY - Security)

**Effort:** 2-3 weeks

* [ ] Docker container spawning (THIS WEEK)
* [ ] Resource limits: CPU, memory, timeout (THIS WEEK)
* [ ] Read-only filesystem (THIS WEEK)
* [ ] Network isolation (THIS WEEK)
* [ ] Pre-built prover images for fast startup
* [ ] Container cleanup after verification
* [ ] Security scanning of container images

**Why:** Security-critical. Running untrusted proof code from PRs requires strict isolation.

=== 3. Verifier Mode (First Bot Mode)

**Effort:** 1 week

* [ ] Silent pass/fail check runs (THIS WEEK)
* [ ] GitHub Check Run API integration (THIS WEEK)
* [ ] GitLab commit status API integration
* [ ] Bitbucket build status API integration
* [ ] Basic failure PR comments
* [ ] Repository configuration for enabling/disabling

**Why:** Simplest bot mode, provides immediate value (automated proof checking).

=== 4. Observability (HIGH PRIORITY)

**Effort:** 1-2 weeks

* [ ] Prometheus metrics endpoint (/metrics)
* [ ] Key metrics: webhook throughput, verification duration, success rate, queue length
* [ ] OpenTelemetry distributed tracing
* [ ] Structured JSON logging
* [ ] Grafana dashboards
* [ ] Alert rules for critical conditions

**Why:** Essential for debugging production issues and monitoring performance.

== Mid-Term Goals (v0.3.0 - Q2 2026)

=== 1. Advisor Mode (ML-Powered Suggestions)

**Effort:** 2-3 weeks

* [ ] Integrate with ECHIDNA Julia ML API for tactic suggestions
* [ ] Post suggestions in PR comments when proofs fail
* [ ] Include confidence scores with suggestions
* [ ] Context-aware suggestions (use proof goal, premises, failed tactics)
* [ ] Repository configuration for suggestion verbosity

**Why:** Help developers fix failing proofs faster with AI assistance.

**Example Output:**
```
‚ùå Proof failed at theorem `list_append_assoc`
   Goal: ‚àÄ xs ys zs, xs ++ (ys ++ zs) = (xs ++ ys) ++ zs

üí° Suggested tactics (via ECHIDNA ML):
  ‚Ä¢ Try `induction xs` to break down the list structure (confidence: 0.65)
  ‚Ä¢ Consider `rewrite app_assoc` if available (confidence: 0.28)
  ‚Ä¢ Check if `simpl` simplifies the goal (confidence: 0.23)
```

=== 2. Regulator Mode (Merge Blocking)

**Effort:** 1-2 weeks

* [ ] Create required GitHub Check Runs (blocks merge)
* [ ] Configurable severity levels (error blocks merge, warning doesn't)
* [ ] Exemption system (allow specific theorems to fail)
* [ ] Required proof coverage per PR (X% of new code must have proofs)
* [ ] Override mechanism for emergencies (with audit log)

**Why:** Enforce proof requirements at the gate for critical projects.

=== 3. Production Hardening

**Effort:** 2-3 weeks

* [ ] Comprehensive error recovery (handle all failure modes gracefully)
* [ ] Rate limiting (100 webhooks/minute per repository)
* [ ] Webhook replay attack prevention
* [ ] Database connection pooling optimization
* [ ] Health checks (/health/ready for database + ECHIDNA connectivity)
* [ ] Graceful shutdown (finish in-progress jobs)
* [ ] Deployment automation (Kubernetes manifests, Helm charts)

**Why:** Production reliability and security.

=== 4. Docker Compose + Kubernetes

**Effort:** 1 week

* [ ] Docker Compose for local development (postgres + echidna + echidnabot)
* [ ] Kubernetes deployment manifests
* [ ] Helm chart for easy installation
* [ ] Horizontal pod autoscaling
* [ ] Persistent volume claims for PostgreSQL
* [ ] Secrets management (GitHub App key, tokens)

**Why:** Easy deployment for users, scalable production setup.

== Long-Term Vision (v1.0.0 - Q3-Q4 2026)

=== 1. Consultant Mode (Interactive Q&A)

**Effort:** 3-4 weeks

* [ ] Natural language queries via PR comments (@echidnabot why did this proof fail?)
* [ ] Proof state inspection via GraphQL API
* [ ] Interactive proof debugging
* [ ] Step-by-step proof explanation
* [ ] Reference similar proven theorems
* [ ] Suggest lemmas to prove first

**Why:** Make formal verification more accessible, especially for learners.

=== 2. Proof Caching & Incremental Verification

**Effort:** 2-3 weeks

* [ ] Cache verified proofs (skip re-verification if unchanged)
* [ ] Incremental verification (only changed theorems + dependents)
* [ ] Proof dependency tracking (which proofs depend on which lemmas)
* [ ] Smart cache invalidation (detect affected proofs)
* [ ] Distributed cache (Redis or similar)

**Why:** Dramatically speed up CI for large proof repositories.

**Impact:** Could reduce verification time from minutes to seconds for typical PRs.

=== 3. Multi-Prover Consensus

**Effort:** 1-2 weeks

* [ ] Configure N provers to verify each proof (e.g., require 3/12 agree)
* [ ] Consensus voting (majority must agree)
* [ ] Disagreement reporting (useful for finding prover bugs)
* [ ] Performance optimization (parallel prover execution)

**Why:** Increase confidence in proofs, detect prover bugs.

=== 4. Distributed Proof Verification

**Effort:** 4-5 weeks

* [ ] Kubernetes-native horizontal scaling
* [ ] Spot instance support (cost optimization for long verifications)
* [ ] Proof job distribution across workers
* [ ] Worker health monitoring
* [ ] Graceful worker shutdown (finish in-progress jobs)

**Why:** Scale to massive proof repositories (e.g., entire Mathlib).

=== 5. Proof Library Integration

**Effort:** 3-4 weeks

* [ ] Mathlib (Lean) automatic import resolution
* [ ] Coq stdlib + ext-lib integration
* [ ] Agda stdlib integration
* [ ] Isabelle/AFP (Archive of Formal Proofs) integration
* [ ] Auto-detect and install missing proof dependencies

**Why:** Seamless use of standard libraries, reduce configuration burden.

== Research Goals (v2.0.0+ - 2027+)

These are ambitious, research-oriented goals:

=== 1. Proof Synthesis (Ambitious - Research)

* [ ] AI-powered proof sketch generation
* [ ] Theorem statement from informal natural language description
* [ ] Proof completion (fill in sorry/admit holes)
* [ ] Cross-prover proof translation (Coq ‚Üî Lean ‚Üî Isabelle)

**Why:** Make formal verification accessible to non-experts.

**Challenge:** Proof synthesis is a hard AI problem, requires significant research.

=== 2. Learning from CI Proofs

* [ ] Continuous ML model improvement from CI proof data
* [ ] Periodic model retraining with new successful proofs
* [ ] A/B testing of ML model versions
* [ ] Privacy-preserving learning (only public repositories)

**Why:** ML models improve over time from real-world usage.

== Technical Debt

=== High Priority

* [ ] Refactor platform adapters to shared crate (with rhodibot, seambot, other bots)
* [ ] Improve error messages (prover-specific guidance on failures)
* [ ] Add integration tests for all 12 provers (via ECHIDNA)
* [ ] Docker image optimization (reduce size, faster builds)
* [ ] Security audit of webhook handling and container isolation

=== Medium Priority

* [ ] Performance optimization (benchmark and optimize hot paths)
* [ ] Memory optimization (handle large proof files efficiently)
* [ ] Better structured logging (prover-specific context)
* [ ] GraphQL schema versioning (avoid breaking changes)

=== Low Priority

* [ ] Plugin system for custom provers (beyond ECHIDNA's 12)
* [ ] Alternative output formats (HTML proof reports, PDF)
* [ ] Multi-language UI support (i18n)

== Community Contributions Welcome

We welcome contributions in these areas:

* **Platform adapters** (Gitea, Codeberg, SourceHut)
* **Prover integrations** (via ECHIDNA - help expand ECHIDNA's prover support)
* **Bot mode implementations** (Consultant, Regulator, custom modes)
* **ML model improvements** (better tactic prediction, premise selection)
* **Documentation** (tutorials, examples, case studies, blog posts)
* **Testing** (integration tests, prover-specific test cases)

See link:CONTRIBUTING.adoc[CONTRIBUTING.adoc] for guidelines.

== Non-Goals

Echidnabot will **NOT**:

* Replace human proof engineers (assists and automates, not replaces)
* Verify proofs without ECHIDNA (delegates to ECHIDNA core, not a prover itself)
* Support non-theorem-prover languages (Python tests ‚â† formal proofs)
* Guarantee soundness independently (relies on ECHIDNA's formal soundness guarantees)
* Become a standalone prover (always orchestrates ECHIDNA)

== Versioning

Echidnabot follows semantic versioning:

* **v0.x.y** - Pre-1.0, breaking changes allowed between minor versions
* **v1.x.y** - Stable API, breaking changes only in major versions
* **vX.0.0** - Major release with new features and possible breaking changes

== Release Cadence

* **Patch releases** (v0.1.x) - As needed for critical bug fixes
* **Minor releases** (v0.x.0) - Every 4-6 weeks with new features
* **Major releases** (v1.0.0) - When production-ready (Q3-Q4 2026 target)

== Current Focus (January 2026)

**This Week:**
1. Container isolation (security critical) ‚ö†Ô∏è
2. Retry logic with backoff (reliability critical) ‚ö†Ô∏è
3. Concurrent job limits (stability critical) ‚ö†Ô∏è
4. Verifier mode (first bot mode) üéØ

**This Month:**
1. Observability (Prometheus + OpenTelemetry)
2. Integration tests (end-to-end webhook flow)
3. Docker Compose setup (easy local development)
4. Advisor mode (ML tactic suggestions)

**This Quarter (Q1 2026):**
1. Production hardening (error recovery, rate limiting)
2. Kubernetes deployment (scalable production)
3. Regulator mode (merge blocking)
4. Proof caching (incremental verification)

== Feedback

Have suggestions for the roadmap? Open an issue or discussion on GitHub!

**Repository:** https://github.com/hyperpolymath/echidnabot
**Maintainer:** Jonathan D.A. Jewell <jonathan.jewell@open.ac.uk>
**License:** PMPL-1.0-or-later

---

*Last Updated:* 2026-01-29 +
*Document Version:* 2.0 (comprehensive update)
